templates:
  - name: 点查1：根据ID溯源
    query: eventId == "${eventId}"
    paramType: dynamic

  - name: 点查2：高基数
    query: srcAddress == "${srcAddress}"
    order: collectorReceiptTime desc
    paramType: dynamic
    aggs:
      - Count
      - TopN
      - DateHistogram

  - name: 点查3：低基数1
    query: severity == ${severity}
    order: collectorReceiptTime desc
    paramType: range
    aggs:
      - Count
      - TopN
      - DateHistogram
    params:
      - 1
#      - 3
#      - 6

  - name: 点查3：低基数2
    query: direction == "${direction}"
    order: collectorReceiptTime desc
    paramType: range
    aggs:
      - Count
      - TopN
      - DateHistogram
    params:
#      - 00
      - 01
#      - 10
#      - 11

  - name: 多条件：AND
    query: srcAddress == "${srcAddress}" AND destAddress == "${destAddress}"
    order: collectorReceiptTime desc
    paramType: dynamic
    aggs:
      - Count
      - TopN
      - DateHistogram

  - name: 多条件：OR
    query: srcAddress == "${srcAddress}" OR destAddress == "${destAddress}"
    order: collectorReceiptTime desc
    paramType: dynamic
    aggs:
      - Count
      - TopN
      - DateHistogram

  - name: 排除场景
    query: srcAddress != "${srcAddress}" AND destAddress != "${destAddress}"
    order: collectorReceiptTime desc
    paramType: dynamic
    aggs:
      - Count
      - TopN
      - DateHistogram

  - name: 范围查询1
    query: bytesIn > ${bytesIn}
    order: collectorReceiptTime desc
    paramType: range
    aggs:
      - Count
      - TopN
      - DateHistogram
    params:
      - 1000
#      - 3000
#      - 5000

  - name: 范围查询2
    query: srcPort < ${srcPort}
    order: collectorReceiptTime desc
    paramType: dynamic
    aggs:
      - Count
      - TopN
      - DateHistogram

  - name: IN查询
    query: appProtocol in ["${appProtocol}", "${appProtocol}", "${appProtocol}"]
    order: collectorReceiptTime desc
    paramType: range
    params:
      - http
      - https
      - sftp
#      - echo
#      - ssh
#      - pop3
#      - dns
#      - ntp
    aggs:
      - Count
      - TopN
      - DateHistogram

  - name: 单次500条详情查询
    query: srcAddress == "${srcAddress}"
    order: collectorReceiptTime desc
    size: 500
    paramType: dynamic
    aggs:
      - Count
      - TopN
      - DateHistogram
